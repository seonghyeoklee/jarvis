# Gmail 기능 명세

## 개요

Gmail API를 통해 이메일을 관리하는 8개의 MCP 도구를 제공한다.

## 도구 목록

### 1. `list_messages` - 메일 목록 조회

받은편지함의 메일 목록을 조회한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `max_results` | `int` | 아니오 | 최대 결과 수. 기본값: 10 |
  | `label` | `str` | 아니오 | 라벨 필터. 기본값: INBOX |
  | `unread_only` | `bool` | 아니오 | 안 읽은 메일만. 기본값: false |

- **반환값**: 메일 목록 (보낸 사람, 제목, 날짜, 스니펫)
- **예시**:
  ```
  사용자: "안 읽은 메일 보여줘"
  도구 호출: list_messages(unread_only=true)

  사용자: "최근 메일 5개 보여줘"
  도구 호출: list_messages(max_results=5)
  ```

### 2. `get_message` - 메일 상세 조회

특정 메일의 전체 내용을 조회한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `message_id` | `str` | 예 | 메일 ID |

- **반환값**: 메일 전문 (보낸 사람, 받는 사람, 제목, 본문, 첨부파일 목록)
- **예시**:
  ```
  도구 호출: get_message(message_id="msg123")
  ```

### 3. `search_messages` - 메일 검색

Gmail 검색 문법으로 메일을 검색한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `query` | `str` | 예 | 검색 쿼리 (Gmail 검색 문법 지원) |
  | `max_results` | `int` | 아니오 | 최대 결과 수. 기본값: 10 |

- **반환값**: 검색된 메일 목록
- **예시**:
  ```
  사용자: "김철수한테 온 메일 찾아줘"
  도구 호출: search_messages(query="from:kimcs@example.com")

  사용자: "지난주에 온 첨부파일 있는 메일"
  도구 호출: search_messages(query="has:attachment after:2025/02/03 before:2025/02/10")
  ```

### 4. `send_message` - 메일 발송

새 이메일을 발송한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `to` | `str` | 예 | 받는 사람 이메일 |
  | `subject` | `str` | 예 | 제목 |
  | `body` | `str` | 예 | 본문 (텍스트) |
  | `cc` | `str` | 아니오 | 참조 |
  | `bcc` | `str` | 아니오 | 숨은 참조 |

- **반환값**: 발송 확인 (메일 ID, 스레드 ID)
- **예시**:
  ```
  사용자: "김철수에게 회의록 보내줘"
  도구 호출: send_message(
    to="kimcs@example.com",
    subject="2월 11일 회의록",
    body="안녕하세요, 오늘 회의록을 공유합니다..."
  )
  ```

### 5. `reply_message` - 메일 답장

기존 메일에 답장한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `message_id` | `str` | 예 | 원본 메일 ID |
  | `body` | `str` | 예 | 답장 본문 |
  | `reply_all` | `bool` | 아니오 | 전체 답장 여부. 기본값: false |

- **반환값**: 발송 확인 (메일 ID)
- **예시**:
  ```
  사용자: "이 메일에 확인했다고 답장해줘"
  도구 호출: reply_message(message_id="msg123", body="확인했습니다. 감사합니다.")
  ```

### 6. `modify_labels` - 라벨 수정

메일의 라벨을 추가하거나 제거한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `message_id` | `str` | 예 | 메일 ID |
  | `add_labels` | `list[str]` | 아니오 | 추가할 라벨 |
  | `remove_labels` | `list[str]` | 아니오 | 제거할 라벨 |

- **반환값**: 수정 확인
- **예시**:
  ```
  사용자: "이 메일 읽음 처리해줘"
  도구 호출: modify_labels(message_id="msg123", remove_labels=["UNREAD"])

  사용자: "이 메일 중요 표시해줘"
  도구 호출: modify_labels(message_id="msg123", add_labels=["IMPORTANT"])
  ```

### 7. `list_labels` - 라벨 목록 조회

사용 가능한 라벨 목록을 조회한다.

- **파라미터**: 없음
- **반환값**: 라벨 목록 (ID, 이름, 타입)
- **예시**:
  ```
  사용자: "내 라벨 목록 보여줘"
  도구 호출: list_labels()
  ```

### 8. `trash_message` - 메일 삭제 (휴지통)

메일을 휴지통으로 이동한다.

- **파라미터**:
  | 이름 | 타입 | 필수 | 설명 |
  |------|------|------|------|
  | `message_id` | `str` | 예 | 메일 ID |

- **반환값**: 삭제 확인
- **예시**:
  ```
  사용자: "이 메일 삭제해줘"
  도구 호출: trash_message(message_id="msg123")
  ```

---

## 에러 처리 정책

| 에러 상황 | 처리 방법 |
|-----------|-----------|
| 인증 만료 | 자동 토큰 갱신 시도. 실패 시 재인증 안내 |
| 잘못된 이메일 주소 | 에러 메시지와 형식 안내 |
| 존재하지 않는 메일 | "해당 메일을 찾을 수 없습니다" 반환 |
| 발송 실패 | 에러 원인 표시 및 재시도 안내 |
| API 할당량 초과 | 재시도 안내 및 대기 시간 표시 |
| 첨부파일 크기 초과 | 파일 크기 제한 안내 (25MB) |
