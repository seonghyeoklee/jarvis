# 설정 가이드

## 1. Google Cloud Console OAuth 설정

### 1.1 프로젝트 생성

1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 상단 프로젝트 선택 → **새 프로젝트** 클릭
3. 프로젝트 이름: `jarvis` (또는 원하는 이름)
4. **만들기** 클릭

### 1.2 API 활성화

1. 좌측 메뉴 → **API 및 서비스** → **라이브러리**
2. 다음 API를 검색하여 각각 **사용 설정**:
   - **Google Calendar API**
   - **Gmail API**

### 1.3 OAuth 동의 화면 설정

1. 좌측 메뉴 → **API 및 서비스** → **OAuth 동의 화면**
2. 사용자 유형: **외부** 선택 (개인 계정의 경우)
3. 앱 정보 입력:
   - 앱 이름: `Jarvis`
   - 사용자 지원 이메일: 본인 이메일
   - 개발자 연락처: 본인 이메일
4. **범위(Scopes)** 추가:
   - `https://www.googleapis.com/auth/calendar`
   - `https://www.googleapis.com/auth/gmail.modify`
   - `https://www.googleapis.com/auth/gmail.send`
5. **테스트 사용자** 추가: 본인 Google 계정 이메일

### 1.4 OAuth 자격 증명 생성

1. 좌측 메뉴 → **API 및 서비스** → **사용자 인증 정보**
2. **사용자 인증 정보 만들기** → **OAuth 클라이언트 ID**
3. 애플리케이션 유형: **데스크톱 앱**
4. 이름: `Jarvis Desktop`
5. **만들기** 클릭
6. **JSON 다운로드** → `~/jarvis/credentials.json`으로 저장

> ⚠️ `credentials.json` 파일은 절대 Git에 커밋하지 마세요! `.gitignore`에 이미 포함되어 있습니다.

---

## 2. 환경변수 설정

```bash
cd ~/jarvis
cp .env.example .env
```

`.env` 파일을 열어 값을 입력합니다:

```env
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret
```

또는 `credentials.json` 파일을 직접 사용하는 경우:

```env
GOOGLE_CREDENTIALS_FILE=credentials.json
```

---

## 3. 의존성 설치

```bash
cd ~/jarvis
uv sync
```

---

## 4. 최초 인증 (토큰 발급)

```bash
uv run jarvis-auth
```

1. 브라우저가 열리며 Google 로그인 페이지 표시
2. 본인 계정으로 로그인
3. "Jarvis가 Google 계정에 액세스하려 합니다" → **허용**
4. "이 앱은 Google의 확인을 받지 않았습니다" → **고급** → **Jarvis(으)로 이동**
5. 인증 완료 → `tokens.json` 파일이 자동 생성됨

> ⚠️ `tokens.json` 파일도 절대 Git에 커밋하지 마세요!

---

## 5. Claude Code 연결

### MCP 서버 등록

```bash
claude mcp add jarvis -- uv run --directory ~/jarvis jarvis
```

### 연결 확인

```bash
claude mcp list
```

`jarvis` 서버가 목록에 표시되면 성공입니다.

### 사용 테스트

Claude Code에서:

```
오늘 일정 알려줘
```

일정 목록이 표시되면 설정 완료!

---

## 트러블슈팅

### "인증 오류" 발생 시

1. `tokens.json` 삭제 후 재인증: `uv run jarvis-auth`
2. OAuth 동의 화면에서 테스트 사용자에 본인 이메일이 있는지 확인

### "API 미활성화" 발생 시

1. Google Cloud Console에서 Calendar API, Gmail API가 활성화되어 있는지 확인

### "할당량 초과" 발생 시

1. Google API는 일일 무료 할당량 제공 (Calendar: 1,000,000 요청/일, Gmail: 250 요청/사용자/초)
2. 일반적인 개인 사용으로는 초과하지 않음
